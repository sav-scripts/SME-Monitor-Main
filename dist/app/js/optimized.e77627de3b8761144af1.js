!function(){var a=(window.Utility={},{}),b={};b.log="log",b.warn="warn",b.error="error",b.debug="debug",b.info="info",Utility.setConsoleMethod=function(b,c){console[b]=1==c?a[b]:function(){}},Utility.disableAllConsoleMethods=function(){for(var a in b)this.setConsoleMethod(a,!1)},Utility.enableAllConsoleMethods=function(){for(var a in b)this.setConsoleMethod(a,!0)},function(){if(!window.console){window.console={};for(var c in b)console[b[c]]=function(){}}for(var c in b)a[b[c]]=console[b[c]];window.Array.prototype.indexOf||(window.Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=c<0?Math.ceil(c):Math.floor(c),c<0&&(c+=b);c<b;c++)if(c in this&&this[c]===a)return c;return-1})}();var c={};Utility.analyzeURL=function(a){if(!c[a]){var b=/^((http[s]?|ftp):\/)?\/?([^:\/\s]+)((\/\w+)*\/)([\w\-\.]+[^#?\s]+)(.*)?(#[\w\-]+)?$/;c[a]=a.match(b)}return c[a]},Utility.getPathWithFilename=function(){return window.location.href.replace(window.location.search,"").replace(window.location.hash,"").replace("?","")},Utility.getPath=function(a){a||(a=window.location.href);var b=-1==a.indexOf("?")?a:a.substr(0,a.indexOf("?"));-1!==b.indexOf("#")&&(b=b.substr(0,b.indexOf("#")));var c=b.split("/"),d=c[c.length-1];for(-1!==d.indexOf(".")&&c.pop(),b=c.join("/");b.length&&"/"==b.charAt(b.length-1);)b=b.slice(0,b.length-1);return b+="/"},Utility.getProtocol=function(a){return a||(a=window.location.href),Utility.analyzeURL(a)[2]},Utility.urlParams=function(){var a=decodeURIComponent(window.location.href),b=a.split("?")[1];if(!b)return{};b=b.split("#")[0];for(var c={},d=b.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");c[f[0]]=f[1]}return c}(),Utility.isLocalhost=function(){var a=window.location.toString().split("/")[2];return"localhost"==a||"192"==a.split(".")[0]}(),Utility.preloadImages=function(a,b,c,d){function e(){function g(){null!=i&&(i.collector[i.name]=j),j.onerror=null,j.onload=null,e()}if(c&&c.apply(null,[f/a.length*100<<0]),f>=a.length)return void(b&&b.apply());var h=a[f],i=null;"string"!=typeof h&&(i=h,h=i.url),f++;var j=new Image;j.onload=g,d&&(j.onerror=function(){console.error("load image error: ["+h+"]"),g()}),j.src=h}if(null==d&&(d=!0),!a||0==a.length)return void(b&&b.apply());var f=0;e()},Utility.shuffleArray=function(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a},Utility.isiOS=function(){var a=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];if(navigator.platform)for(;a.length;)if(navigator.platform===a.pop())return!0;return!1}}(),function(){var a=window.PatternSamples={};a.email=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,a.phone=/^(09)[0-9]{8}$/,a.number=/[0-9]/g,a.nonNumber=/[^0-9]/g,a.onlySpace=/^\s*$/,a.localPhone=/^(0)\d{1,3}(-)\d{5,8}$/,a.personId=/^[A-Z]{1}[1-2]{1}[0-9]{8}$/,a.numberAndLetters=/^[a-zA-Z0-9]*$/}(),function(){function a(){if(!b&&f._isActive){var a=document.documentElement;d.left=(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),d.top=(window.pageYOffset||a.scrollTop)-(a.clientTop||0),d.width=$(window).width(),d.height=$(window).height(),e.scrollTop=$(window).scrollTop(),c&&c.call(null,d)}}var b=!1,c=null,d={top:0,left:0,width:0,height:0},e={scrollTop:0},f=window.ScrollListener={_isActive:!1,init:function(){return f},bind:function(a){c=a},active:function(){return f._isActive=!0,$(window).on("scroll",a),a(),f},disactive:function(){return f._isActive=!1,$(window).unbind("scroll",a),f},testDom:function(a,b,c){var e=a.getBoundingClientRect();void 0===b&&(b=0),void 0===c&&(c=0);var f=b,g=d.height+c;return{bound:e,topInside:e.top>=f&&e.top<=g,bottomInside:e.bottom>=f&&e.bottom<=g,contentInside:e.top<g&&e.bottom>f}},scrollTo:function(a,b,c){var d=c||1e3,f=Math.abs(a-e.scrollTop),g=Math.min(.8,f/d);TweenMax.killTweensOf(e),e.scrollTop=$(window).scrollTop(),TweenMax.to(e,g,{scrollTop:a,onStart:function(){},onUpdate:function(){window.scrollTo($(window).scrollLeft(),e.scrollTop)},onComplete:b})}}}(),function(){var a=window._FAKE_DATA_;window.ApiProxy={callApi:function(b,c,d,e){function f(a){e&&e.call(null,a)}var g="../api/"+b;if(!1!==d&&(d&&!0!==d||(d=b)),a&&Main.settings.useFakeData&&d){var h=a[d];TweenMax.delayedCall(.1,function(){f(h)})}else $.ajax({url:g,type:"POST",data:c,dataType:"json"}).done(f).fail(function(){f({error:"API: ["+b+"] 無法取得伺服器回應"})})}}}(),function(){function a(a){f=a,c.call(null,f)}function b(){if("onhashchange"in window)window.onhashchange=function(){h.update()};else{var a=window.location.hash;window.setInterval(function(){window.location.hash!=a&&(a=window.location.hash,h.update())},100)}}var c,d=!1,e=!1,f=null,g=!1,h=window.Hash={init:function(a){if(d)throw new Error("is initialized already");return d=!0,h.bind(a),b(),h},bind:function(a){return c=a,h},startListening:function(){if(!e){if(e=!0,f){var b=h.getHash();b!==f&&a(b)}return h}},stopListening:function(){if(e)return e=!1,h},analysis:function(a){for(var b,c=[],d=[],e=0,f=0;f<200&&(f++,-1!==(b=a.indexOf("/",e)));)d.push(b),e=b+1;var g,h,i;for(g=0;g<d.length;g++)h=d[g],i=d[g+1],void 0===i&&(i=a.length),c.push(a.slice(h,i));return c},to:function(a,b){h.getHash()!==a&&(b&&(g=!0),window.location.hash="#"+a)},update:function(){e&&(g?g=!1:a(h.getHash()))},getHash:function(){return window.location.hash.replace("#","")}}}(),function(){"use strict";function a(){var a=b.viewport,c=a.index;a.width=$(window).width(),a.height=$(window).height(),a.index=a.width<=a.ranges[0]?0:1,a.changed=c!==a.index,MainPage.resize()}var b=window.Main={testDomain:"apac.jktarots.com:9454",localSettings:{},settings:{isLocal:!1,useFakeData:!1,debug:!1,isiOS:!1,isLineBrowser:!1},viewport:{width:0,height:0,ranges:[640],index:-1,changed:!1},init:function(){"local.savorks.com"!=window.location.host&&"socket.savorks.com"!=window.location.host&&window.location.host!=b.testDomain||($.extend(b.settings,b.localSettings),Main.settings.isLocal=!0,Main.settings.useFakeData=!0,Main.settings.debug=!0),b.settings.isLineBrowser=Boolean(navigator.userAgent.match("Line")),b.settings.isiOS=Utility.isiOS(),window._CLICK_=b.settings.isiOS?"touchend":"click",Menu.init(),$(window).on("resize",a),a(),MainPage.init()}}}(),function(){function a(a){"menu-button"===a.target.className&&"/Initiatives"===a.target.getAttribute("anchor")||$.contains(b.dropMenu[0],a.target)||e.switchDropMenu(!1)}var b={},c=!0,d={},e=window.Menu={init:function(){b.container=$("#header"),$.extend(b,{topPart:b.container.find(".top-part"),menuPart:b.container.find(".menu-part"),buttonContainer:b.container.find(".button-container"),baseLine:b.container.find(".baseline")}),b.buttonContainer.find(".menu-button").on(_CLICK_,function(){if(!c){var a=this.getAttribute("anchor");"/Download"===a?Hash.to("/Download/List"):"/Initiatives"===a?e.switchDropMenu():(Hash.to(a),MainPage.toSection(a))}}).each(function(a,b){var c=b.getAttribute("anchor");d[c]=b})},setFocusTo:function(a){e.setFocusToDom(d[a])},setFocusToDom:function(a){var c=a.getBoundingClientRect(),d=b.menuPart[0].getBoundingClientRect(),e=c.left-d.left,f=c.width;TweenMax.to(b.baseLine,.5,{left:e,width:f,ease:Power3.easeOut})},lock:function(){c=!0},unlock:function(){c=!1},setupDropMenu:function(a){function c(a){var b=$(document.createElement("div"));b[0].className="button",b.text(a.title),b.on(_CLICK_,function(){e.switchDropMenu(!1),Hash.to("/Initiatives/"+a.id)}),f.append(b)}var f=b.dropMenu=b.container.find(".drop-menu"),g=d["/Initiatives"],h=g.getBoundingClientRect(),i=b.menuPart[0].getBoundingClientRect(),j=h.left-i.left+.5*h.width;f.css("left",j);var k;for(k=0;k<a.length;k++)c(a[k]);var l=f._height=f.height()+2;f._isOpen=!1,f.css("overflow","hidden"),TweenMax.set(f,{autoAlpha:0});var m=f._tl=new TimelineMax({paused:!1});m.add(function(){TweenMax.set(f,{autoAlpha:0})}),m.set(f,{autoAlpha:1,height:0},.01),m.to(f,.35,{height:l}),m.pause()},switchDropMenu:function(c){if(void 0===c&&(c=!b.dropMenu._isOpen),c!==b.dropMenu._isOpen){(b.dropMenu._isOpen=c)?($(window).bind("mouseup",a),b.dropMenu._tl.play()):($(window).unbind("mouseup",a),b.dropMenu._tl.reverse())}}}}(),function(){function a(a){if(d.header.toggleClass("pin-mode",a.top>=e.topPartHeight),!g){var b,c,f,h;for(b=0;b<d.sections.length;b++)if(c=d.sections[b],f=ScrollListener.testDom(c,e.topPartHeight),f.contentInside){h=c._anchor;break}h||(h=d.sections[d.sections.length-1]._anchor),Menu.setFocusTo(h)}}var b,c=!1,d={},e={topPartHeight_0:100,topPartHeight_1:72,headerHeight_0:99,headerHeight_1:99,menuHeight_0:32,menuHeight_1:32,topPartHeight:0,headerHeight:0,menuHeight:0},f={},g=!1,h=window.MainPage={init:function(){d={header:$("#header"),news:$("#news"),events:$("#events"),publication:$("#publication"),pictures:$("#pictures"),videos:$("#videos"),sections:$(".section"),innerPage:$("#inner-page")},b={"/Home":{section:!0},"/News":{section:!0},"/Events":{section:!0},"/Publication":{section:!0},"/Pictures":{section:!0},"/Videos":{section:!0}},d.sections.each(function(a,b){b._anchor=b.getAttribute("anchor"),f[b._anchor]=b}),c=!0,h.resize(),ScrollListener.init().bind(a),Hash.init(function(a){var b=Hash.analysis(a);h.handleHash(b)}),InnerPage.init(function(){Menu.unlock(),Hash.startListening().update(),ScrollListener.active()})},handleHash:function(a){if(0==a.length&&(a=["/Home"]),1==a.length){var c=a[0];b[c]&&(g?InnerPage.close(c):h.toSection(c))}else a.length>=2&&InnerPage.handleHash(a)},toHash:function(a){g?Hash.to(a):h.toSection(a)},toSection:function(a,b){var c=f[a];if(c){var d=$(c).offset().top-e.menuHeight;ScrollListener.scrollTo(d,b)}},close:function(a){if(g)a.call();else{g=!0,InnerPage.Banners.stopLoop();var b=new TimelineMax;b.to(d.sections,.5,{autoAlpha:0}),b.add(function(){ScrollListener.scrollTo(0,function(){a.call()})},0)}},closeSections:function(){d.sections.toggleClass("close-mode",!0)},openSections:function(){d.sections.toggleClass("close-mode",!1)},open:function(a,b){h.toSection(a,function(){Menu.setFocusTo(a);var c=new TimelineMax;c.to(d.sections,.5,{autoAlpha:1}),c.add(function(){g=!1,InnerPage.Banners.startLoop(),b&&b.call()})})},resize:function(){if(c){var a=Main.viewport;e.topPartHeight=e["topPartHeight_"+a.index],e.headerHeight=e["headerHeight_"+a.index],e.menuHeight=e["menuHeight_"+a.index],InnerPage.News.resize()}}}}(),function(){var a,b,c,d={},e=window.InnerPage={$container:null,init:function(b){function c(){function a(){0===--f&&b.call()}var c,d=[e.Banners,e.News,e.Events,e.Publication,e.Pictures,e.Videos,e.Links,e.Initiatives,e.Download],f=d.length;for(c=0;c<d.length;c++)d[c].init(a)}d.container=e.$container=$("#inner-page"),$.extend(d,{loadingIcon:d.container.find(".loading-icon"),head:d.container.find(".inner-page-head"),content:d.container.find(".content")}),d.headTitle=d.head.find(".title"),a={"/News":e.News,"/Events":e.Events,"/Publication":e.Publication,"/Pictures":e.Pictures,"/Videos":e.Videos,"/Initiatives":e.Initiatives,"/Download":e.Download},c()},handleHash:function(b){var d=b[0],f=b[1],g=a[d];if(g){var h=g.validateContent(f);h&&(c?e.switchPage(d,g,h):e.open(d,g,h))}},open:function(a,e,f){c||(c=!0,Hash.stopListening(),b=e,d.headTitle.text(b.name),MainPage.close(function(){Menu.setFocusTo(a);var b=new TimelineMax;b.set(d.container,{autoAlpha:1,height:0,paddingTop:0}),b.to(d.container,.4,{height:386,paddingTop:109}),b.add(function(){d.loadingIcon.toggleClass("hide-mode",!1),e.loadContent(f,function(a){d.loadingIcon.toggleClass("hide-mode",!0),d.content.prepend(a);var b=d.content.height(),c=d.head.height()+b;MainPage.closeSections(),TweenMax.killTweensOf(d.container);var e=new TimelineMax;e.set(d.content,{autoAlpha:0}),e.to(d.container,.4,{height:c},.5),e.to(d.content,.4,{autoAlpha:1},.5),e.add(function(){Hash.startListening()})})})}))},updateSize:function(){var a=d.content.height(),b=d.head.height()+a;TweenMax.to(d.container,.4,{height:b})},close:function(a){if(c){c=!1,Hash.stopListening(),MainPage.openSections(),TweenMax.killTweensOf(d.container);var e=new TimelineMax;e.to(d.container,.5,{height:0,paddingTop:0}),e.set(d.container,{autoAlpha:0}),e.add(function(){b&&(b.clearContent(),b=null),MainPage.open(a,function(){Hash.startListening()})})}},switchPage:function(a,f,g){Hash.stopListening();var h=new TimelineMax;h.to(d.container,.5,{height:0,paddingTop:0}),h.set(d.container,{autoAlpha:0}),h.add(function(){b&&(b.clearContent(),b=null),c=!1,e.open(a,f,g)})}}}(),function(){function a(a,b){var c=e[a],d=c.image;if(c.item)b.call(null,c.item);else{var f=new Image;f.onload=function(){f.className="banner-item",c.item=f,b.call(null,c.item)},f.src=d,$(f).on(_CLICK_,function(){c.link&&window.open(c.link,"_blank")})}}function b(b){if(!j)return void c.restart();i=b,a(b,function(a){var b=d;d=a,f.content.append(d);var g=new TimelineMax;b?(g.set(d,{left:"100%"}),g.to(b,.7,{left:"-100%",ease:Power1.easeInOut}),g.to(d,.7,{left:"0",ease:Power1.easeInOut},0),g.add(function(){$(b).detach()})):(g.set(d,{autoAlpha:0}),g.to(d,.6,{autoAlpha:1,ease:Power1.easeIn})),g.add(function(){e.length>1&&c.restart()})})}var c,d,e,f={},g=!1,h=4.5,i=0,j=!0;window.InnerPage.Banners={init:function(a){f.container=$("#banner"),$.extend(f,{content:f.container.find(".content")}),ApiProxy.callApi("banners",{},!0,function(d){d.error?alert(d.error):(e=d.data_list,c=new TimelineMax({paused:!0}),c.add(function(){var a=i+1;a>=e.length&&(a=0),b(a)},h),b(i)),g=!0,a.call()})},startLoop:function(){j=!0},stopLoop:function(){j=!1}}}(),function(){function a(a){var b,c,d,e="id",f="/News/",g={};for(d=0;d<a.length;d++)b=a[d],(c=b[e])&&(b.hash=f+c,g[c]=b);return g}var b,c={},d=!1,e=null,f={},g=null,h=window.InnerPage.News={name:"Latest News",init:function(b){return c.container=$("#news"),$.extend(c,{content:c.container.find(".content"),itemContainer:c.container.find(".item-container"),itemSample:c.container.find(".item"),innerPageContainer:InnerPage.$container.find("#news-inner-page")}),c.btnBack=c.innerPageContainer.find(".btn-back").on(_CLICK_,function(){Hash.to("/News")}),c.innerPageContainer.css("display","block").detach(),c.itemSample.detach(),ApiProxy.callApi("news_release",{},null,function(h){h.error?alert(h.error):(e=h.data_list,f=a(e),g=new ItemLister(h.data_list,c.content,c.itemSample,function(a){a.link||a.hash&&Hash.to(a.hash)})),d=!0,b.call()}),h},validateContent:function(a){var b=a.slice(1,a.length);return!!f[b]&&b},loadContent:function(a,d){var e=f[a],g=e.content_url_desktop,h=document.createElement("div");$(h).load(g,function(){b=h,c.innerPageContainer.prepend(h),d.call(null,c.innerPageContainer)})},clearContent:function(){b&&($(b).detach(),b=null),c.innerPageContainer.detach()},resize:function(){if(d){Main.viewport.changed&&g.resize()}}}}(),function(){var a={},b=!1,c=null,d=null,e=window.InnerPage.Events={init:function(f){return a.container=$("#events"),$.extend(a,{content:a.container.find(".content"),itemContainer:a.container.find(".item-container"),itemSample:a.container.find(".item")}),a.itemSample.detach(),ApiProxy.callApi("events",{},null,function(e){e.error?alert(e.error):(c=e.data_list,d=new ItemLister(e.data_list,a.content,a.itemSample,function(a){window.open(a.link,"_blank")})),b=!0,f.call()}),e},validateContent:function(){return!1},resize:function(){if(b){Main.viewport.changed&&d.resize()}}}}(),function(){function a(a){function c(a){a.hash&&Hash.to(a.hash)}var i={page_index:0,page_size:3};ApiProxy.callApi("publication",i,null,function(i){i.error?alert(i.error):(f=i.data_list,g=b(f),h=new ItemLister(i.data_list,d.content,d.itemSample,c,function(a,b){var d=a.find(".thumb");d.css("background-image","url("+b.thumb_desktop+")").on(_CLICK_,function(){c.call(null,this._dataObj)}),d[0]._dataObj=b,a.find(".date").text(b.date),a.find(".title").text(b.title),a.find(".sub-title").text(b.description)})),e=!0,a.call()})}function b(a){var b,c,d,e="type",f="/Publication/",g={};for(d=0;d<a.length;d++)b=a[d],(c=b[e])&&(b.hash=f+c,g[c]=b);return g}var c,d={},e=!1,f=null,g={},h=null,i=window.InnerPage.Publication={name:"Publication",init:function(b){return d.container=$("#publication"),$.extend(d,{content:d.container.find(".content"),itemContainer:d.container.find(".item-container"),itemSample:d.container.find(".item"),innerPageContainer:InnerPage.$container.find("#publication-inner-page")}),d.innerPageContainer.css("display","block").detach(),d.itemSample.detach(),PublicationContent.init(d.innerPageContainer),a(b),i},validateContent:function(a){var b=a.slice(1,a.length);return!!g[b]&&b},loadContent:function(a,b){PublicationContent.toContent(a,function(){b.call(null,d.innerPageContainer)})},clearContent:function(){c&&($(c).detach(),c=null),d.innerPageContainer.detach()},resize:function(){if(e){Main.viewport.changed&&h.resize()}}}}(),function(){function a(){f.tabs.toggleClass("active-mode",!1),f.tableContainer.find(".tab-"+j).toggleClass("active-mode",!0);var a;for(a=0;a<g.length;a++){var b=g[a];f.contentTable.toggleClass("type-"+b,!1)}f.contentTable.toggleClass("type-"+j,!0)}function b(){f.contentTable.find(".sample").detach()}function c(a,c,e){b();var f,g=c*e,h=g+e;for(g<0&&(g=0),h>a.length&&(h=a.length),f=g;f<h;f++)d(a[f])}function d(a){var b=f.itemSample.clone(),c=b.find(".checkbox"),d="publication-checkbox-"+a.id;c.find("input")[0].id=d,c.find("label")[0].setAttribute("for",d),b.find(".col-download").find(".filesize").text(a.file_size),b.find(".thumb").css("background-image","url("+a.thumb_small_desktop+")"),b.find(".col-date").text(a.date),b.find(".col-title").text(a.title),b.find(".col-description").text(a.description),f.contentTable.append(b)}var e,f={},g=["Monitor","Collections","Journals"],h=!1,i=10,j=null,k={Monitor:null,Collections:null,Journals:null},l=window.PublicationContent={init:function(a){f.container=a,f.tableContainer=f.container.find(".table-container"),f.contentTable=f.tableContainer.find(".content-table"),f.itemSample=f.container.find(".sample").detach(),f.tabs=f.tableContainer.find(".type-tabs").find(".tab"),f.tabs.each(function(a,b){var c=$(b),d=b.getAttribute("anchor");c.on(_CLICK_,function(){l.changeContent(d)})}),e=new PageSelector(f.container.find(".page-selector"),function(a){l.changeContent(j,a)}),f.btnBack=f.container.find(".btn-back").on(_CLICK_,function(){Hash.to("/Publication")}),f.btnDownload=f.container.find(".btn-download").on(_CLICK_,function(){})},toContent:function(a,b){function c(){l.changeContent(a,0),b.call()}h?c():l.loadAllData(c)},changeContent:function(b,d){var f=b!==j;j=b;var g=k[j];if(a(),f)void 0===d&&(d=g.pageIndex),e.reset(g.numPages,g.pageIndex);else{if(d===g.pageIndex)return void console.log("same index: "+d)}g.pageIndex=d,c(g.dataList,d,i),InnerPage.updateSize()},loadAllData:function(a){function b(){var d=g[c];ApiProxy.callApi("publication",{search_type:d,page_index:0,page_size:9999},"publication."+d,function(e){if(e.error)alert(e.error);else{var f=e.data_list,j=Math.ceil(f.length/i);k[d]={pageIndex:0,numPages:j,dataList:f},c++,c<g.length?b():(h=!0,a.call())}})}var c=0;b()}}}(),function(){function a(a,b){var d=this;d._$container=a,d._cbOnChange=b;var e=d._$doms={};e.arrowPrev=a.find(".arrow-prev").on(_CLICK_,function(){d.toPage(d._pageIndex-1)}),e.arrowNext=a.find(".arrow-next").on(_CLICK_,function(){d.toPage(d._pageIndex+1)}),e.arrowMorePrev=a.find(".arrow-more-prev").on(_CLICK_,function(){d.toPage(d._pageIndex-c)}),e.arrowMoreNext=a.find(".arrow-more-next").on(_CLICK_,function(){d.toPage(d._pageIndex+c)}),e.pageIndex=a.find(".page-input").on("change",function(){var a=parseInt($(this).val());isNaN(a)&&(a=1),a-=1,console.log("on change: "+a),d.toPage(a)}),e.numPages=a.find(".num-pages")}function b(){var a=this,b=a._$doms,c=a._numPages,d=a._pageIndex;b.arrowPrev.toggleClass("fade-mode",d<=0),b.arrowMorePrev.toggleClass("fade-mode",d<=0),b.arrowNext.toggleClass("fade-mode",d>=c-1),b.arrowMoreNext.toggleClass("fade-mode",d>=c-1)}var c=10;window.PageSelector=a,a.prototype={_$container:void 0,_cbOnChange:void 0,_$doms:void 0,_pageIndex:0,_numPages:0,reset:function(a,c){var d=this;d._numPages=a,d._pageIndex=c,d._$doms.pageIndex.val(d._pageIndex+1),d._$doms.numPages.text(d._numPages),b.call(d)},toPage:function(a,c){var d=this,e=d._pageIndex;a<0&&(a=0),a>=d._numPages&&(a=d._numPages-1),d._pageIndex=a,d._$doms.pageIndex.val(d._pageIndex+1),(c||e!==a)&&(b.call(d),d._cbOnChange&&d._cbOnChange.call(null,d._pageIndex))}}}(),function(){function a(a){var b,c,d,e="id",f="/Pictures/",g={};for(d=0;d<a.length;d++)b=a[d],(c=b[e])&&(b.hash=f+c,g[c]=b);return g}function b(a){var b;for(b=0;b<a.length;b++)c(a[b]);f.innerPageItemContainer.append(f.innerPageSpacer)}function c(a){var b=f.innerPageItemSample.clone();b.find(".thumb").css("background-image","url("+a.thumb_desktop+")"),b.find(".title").text(a.filename),f.innerPageItemContainer.append(b)}var d,e,f={},g=!1,h=null,i=null,j=window.InnerPage.Pictures={name:"Pictures",init:function(b){return f.container=$("#pictures"),$.extend(f,{content:f.container.find(".content"),itemContainer:f.container.find(".item-container"),itemSample:f.container.find(".item"),innerPageContainer:InnerPage.$container.find("#pictures-inner-page")}),f.btnBack=f.innerPageContainer.find(".btn-back").on(_CLICK_,function(){Hash.to("/Pictures")}),f.btnBack=f.innerPageContainer.find(".btn-download").on(_CLICK_,function(){e&&window.open(e,"_blank")}),f.albumDetail=f.innerPageContainer.find(".album-detail"),f.innerPageContainer.css("display","block").detach(),f.itemSample.detach(),f.innerPageItemContainer=f.innerPageContainer.find(".item-container"),f.innerPageItemSample=f.innerPageItemContainer.find(".item").detach(),f.innerPageSpacer=f.innerPageItemContainer.find(".spacer").detach(),ApiProxy.callApi("album",{},null,function(c){c.error?alert(c.error):(h=c.data_list,d=a(h),i=new ItemLister(c.data_list,f.content,f.itemSample,function(a){a.link||a.hash&&Hash.to(a.hash)})),g=!0,b.call()}),j},validateContent:function(a){var b=a.slice(1,a.length);return!!d[b]&&b},loadContent:function(a,c){ApiProxy.callApi("pictures",{album_id:a},null,function(g){var h=d[a];f.albumDetail.find(".date").text(h.date),f.albumDetail.find(".title").text(h.title),f.albumDetail.find(".sub-title").text(h.sub_title),e=g.download_url,b(g.data_list),c.call(null,f.innerPageContainer)})},clearContent:function(){f.innerPageItemContainer.empty(),f.innerPageContainer.detach()},resize:function(){if(g){Main.viewport.changed&&i.resize()}}}}(),function(){var a={},b=!1,c=null,d=null,e=window.InnerPage.Videos={init:function(f){return a.container=$("#videos"),$.extend(a,{content:a.container.find(".content"),itemContainer:a.container.find(".item-container"),itemSample:a.container.find(".item")}),a.itemSample.detach(),ApiProxy.callApi("videos",{},null,function(e){e.error?alert(e.error):(c=e.data_list,d=new ItemLister(e.data_list,a.content,a.itemSample,function(a){window.open(a.link,"_blank")},null,{0:1,1:4})),b=!0,f.call()}),e},validateContent:function(){return!1},resize:function(){if(b){Main.viewport.changed&&d.resize()}}}}(),function(){function a(){var a,c=0;for(a=0;a<e.length;a++)b(e[a]),c+=i;g.itemWrapper.width(c)}function b(a){var b=g.itemSample.clone();b.find(".thumb").css("background-image","url("+a.thumb+")").on(_CLICK_,function(){window.open(a.link,"_blank")}),b.find(".title").text(a.title),g.itemWrapper.append(b)}function c(a){if(a!==k&&!(a>=f||a<0)){k=a;var b=-k*j;TweenMax.killTweensOf(g.itemWrapper),TweenMax.to(g.itemWrapper,.5,{left:b,ease:Power1.easeOut}),d()}}function d(){g.arrowPrev.toggleClass("hide-mode",0===k),g.arrowNext.toggleClass("hide-mode",k>=f-1)}var e,f,g={},h=!1,i=0,j=0,k=-1,l=3;window.InnerPage.Links={init:function(b){g.container=$("#links"),$.extend(g,{arrowPrev:g.container.find(".arrow-prev"),arrowNext:g.container.find(".arrow-next"),itemContainer:g.container.find(".item-container"),itemWrapper:g.container.find(".item-wrapper"),itemSample:g.container.find(".item")});var d=g.itemSample;i=d.width()+parseInt(d.css("margin-left"))+parseInt(d.css("margin-right")),j=i*l,g.itemSample.detach(),g.arrowPrev.on(_CLICK_,function(){c(k-1)}),g.arrowNext.on(_CLICK_,function(){c(k+1)}),ApiProxy.callApi("links",{},null,function(d){d.error?alert(d.error):(e=d.data_list,f=Math.ceil(e.length/l),a(),c(0)),h=!0,b.call()})}}}(),function(){function a(a){var b,c,d,e="id",f="/Initiatives/",g={};for(d=0;d<a.length;d++)b=a[d],(c=b[e])&&(b.hash=f+c,g[c]=b);return g}var b,c={},d=!1,e=null,f={},g=window.InnerPage.Initiatives={name:"Initiatives",init:function(b){return c.container=$("#news"),$.extend(c,{innerPageContainer:InnerPage.$container.find("#initiatives-inner-page")}),c.btnBack=c.innerPageContainer.find(".btn-back").on(_CLICK_,function(){Hash.to("/Home")}),c.innerPageContainer.css("display","block").detach(),ApiProxy.callApi("initiatives",{},null,function(c){c.error?alert(c.error):(e=c.data_list,f=a(e),Menu.setupDropMenu(e)),d=!0,b.call()}),g},validateContent:function(a){var b=a.slice(1,a.length);return!!f[b]&&b},loadContent:function(a,d){var e=f[a],g=e.content_url_desktop,h=document.createElement("div");$(h).load(g,function(){b=h,c.innerPageContainer.prepend(h),d.call(null,c.innerPageContainer)})},clearContent:function(){b&&($(b).detach(),b=null),c.innerPageContainer.detach()},resize:function(){}}}(),function(){var a,b={},c=!1,d=window.InnerPage.Download={name:"Download",init:function(a){return $.extend(b,{innerPageContainer:InnerPage.$container.find("#download-inner-page")}),b.innerPageContainer.css("display","block").detach(),DownloadContent.init(b.innerPageContainer),c=!0,a.call(),d},validateContent:function(a){return"/List"===a&&"All"},loadContent:function(a,c){DownloadContent.toContent(a,function(){c.call(null,b.innerPageContainer)})},clearContent:function(){a&&($(a).detach(),a=null),b.innerPageContainer.detach()},resize:function(){}}}(),function(){function a(){e.contentTable.find(".sample").detach()}function b(b,d,e){a();var f,g=d*e,h=g+e;for(g<0&&(g=0),h>b.length&&(h=b.length),f=g;f<h;f++)c(b[f])}function c(a){var b=e.itemSample.clone(),c=b.find(".checkbox"),d="publication-checkbox-"+a.id;c.find("input")[0].id=d,c.find("label")[0].setAttribute("for",d),b.find(".col-download").find(".filesize").text(a.file_size),b.find(".col-date").text(a.date),b.find(".col-title").text(a.title),e.contentTable.append(b)}var d,e={},f=!1,g=["All"],h=10,i=null,j={All:null},k=window.DownloadContent={init:function(a){e.container=a,e.tableContainer=e.container.find(".table-container"),e.contentTable=e.tableContainer.find(".content-table"),e.itemSample=e.container.find(".sample").detach(),d=new PageSelector(e.container.find(".page-selector"),function(a){k.changeContent(i,a)}),e.btnBack=e.container.find(".btn-back").on(_CLICK_,function(){Hash.to("/Home")}),e.btnDownload=e.container.find(".btn-download").on(_CLICK_,function(){})},toContent:function(a,b){function c(){k.changeContent(a,0),b.call()}f?c():k.loadAllData(c)},changeContent:function(a,c){var e=a!==i;i=a;var f=j[i];if(e)void 0===c&&(c=f.pageIndex),d.reset(f.numPages,f.pageIndex);else{if(c===f.pageIndex)return void console.log("same index: "+c)}f.pageIndex=c,b(f.dataList,c,h),InnerPage.updateSize()},loadAllData:function(a){function b(){var d=g[c];ApiProxy.callApi("download",{page_index:0,page_size:9999},!0,function(e){if(e.error)alert(e.error);else{var i=e.data_list,k=Math.ceil(i.length/h);j[d]={pageIndex:0,numPages:k,dataList:i},c++,c<g.length?b():(f=!0,a.call())}})}var c=0;b()}}}(),function(){function a(a,c,d,e,f,g){var h=this;h._dataList=a,h._$container=c,h._$itemSample=d,h._cbOnThumbClick=e,h._cbApplyData=f,h._$itemContainer=c.find(".item-container"),g&&(h._pageSize=g),b.call(h),h._dotPager=new DotPager(h._$container.find(".page-dot-container"),h._dataList.length,h,h._$container.find(".arrow-prev"),h._$container.find(".arrow-next")),h.resize()}function b(){var a=this;a._itemList=[];var b,d,e;for(b=0;b<a._dataList.length;b++)d=a._dataList[b],e=a._$itemSample.clone(),c(a,e,d),a._itemList.push(e)}function c(a,b,c){a._cbApplyData?a._cbApplyData.call(null,b,c):(b.find(".thumb").css("background-image","url("+c.thumb_desktop+")").on(_CLICK_,function(){a._cbOnThumbClick.call(null,c)}),b.find(".date").text(c.date),b.find(".title").text(c.title),b.find(".sub-title").text(c.sub_title))}function d(a,b){var c=this;if(b||c._pageIndex!==a){c._pageIndex=a;var d=c._$itemContainer.find(".item");c._isLocking=!0;var e=new TimelineMax;d.each(function(a,b){e.to(b,.4,{marginTop:-50,autoAlpha:0,onCompleteParams:[b],onComplete:function(a){}},.2*a)}),e.add(function(){d.detach()});var f,g,h,i=c._pageIndex,j=c._dotPager._pageSize,k=i*j,l=k+j;for(l>c._itemList.length&&(l=c._itemList.length),f=k;f<l;f++)g=c._itemList[f],h=k==f?"+=.1":"-=.3",e.set(g,{autoAlpha:0,marginTop:50},0),e.to(g,.4,{autoAlpha:1,marginTop:0,onStartParams:[g],onStart:function(a){c._$itemContainer.append(a)}},h);e.add(function(){c._isLocking=!1})}}window.ItemLister=a,a.prototype={_dataList:null,_$container:null,_$itemSample:null,_$itemContainer:null,_$pageDotContainer:null,_itemList:null,_cbOnThumbClick:null,_cbApplyData:null,_dotPager:void 0,_pageIndex:-1,_pageSize:{0:1,1:3},_isLocking:!1,resize:function(){var a=this,b=a._pageSize[Main.viewport.index];a._dotPager.reset(b,function(b){d.call(a,b)}),d.call(a,0,!0)}}}(),function(){function a(a,b,c,d,e){var f=this;this._$container=a,this._numItems=b,this._itemLister=c,this._$arrowPrev=d,this._$arrowNext=e,this._$arrowPrev.on(_CLICK_,function(){if(!f._itemLister._isLocking){var a=f._pageIndex-1;a<0||f.setPageIndex(a)}}),this._$arrowNext.on(_CLICK_,function(){if(!f._itemLister._isLocking){var a=f._pageIndex+1;a>=f._numPages||f.setPageIndex(a)}})}function b(){var a=this;a._$arrowPrev.toggleClass("hide-mode",0===a._pageIndex),a._$arrowNext.toggleClass("hide-mode",a._pageIndex===a._numPages-1)}window.DotPager=a,a.prototype={_$container:null,_$arrowPrev:null,_$arrowNext:null,_numItems:0,_pageIndex:0,_numPages:0,_pageSize:0,_cbOnChange:null,_dotList:null,_itemLister:null,reset:function(a,c){var d=this;d._pageIndex=0,d._pageSize=a,d._numPages=Math.ceil(d._numItems/a),d._cbOnChange=c,d._$container.empty(),d._dotList=[];var e,f;for(e=0;e<d._numPages;e++)f=$(document.createElement("div")),f[0].className="dot",f[0]._pageIndex=e,d._$container.append(f),e===d._pageIndex&&f.toggleClass("focus-mode",!0),f.on(_CLICK_,function(){d._itemLister._isLocking||d.setPageIndex(this._pageIndex)});b.call(d)},setPageIndex:function(a){var c=this;c._pageIndex=a,c._cbOnChange.call(null,c._pageIndex);var d=c._$container.find(".dot").toggleClass("focus-mode",!1);$(d[c._pageIndex]).toggleClass("focus-mode",!0),b.call(c)}}}();